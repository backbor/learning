Задача проекта сфомулирована следующим образом: Разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность. Исходные данные содержались в 4х файлах market_file.csv(df_market_file) Таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведени. market_money.csv(df_market_money) Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом. market_time.csv(df_market_time) Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода. money.cs(df_money) Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.

Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.
В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.
Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.

Посредством инструмента GridSearchCV
Педбирались параметры для моделей 
DecisionTreeClassifier
KNeighborsClassifier
SVC
LogisticRegression

Выбор лучшей модели определялся на основе метрики F1
В итоге выбор был остановлен на модели логистической регресси со следующими параметрами.
LogisticRegression(penalty='l1', random_state=58, solver='liblinear'), 'models__C': 1, 'preprocessor__num': MinMaxScaler()
Качетсво модели по F1 0.814578 на тренировойной выборке 
и 0.8706896551724138 на тестовой.

Проведен анализ важности признаков инструментом Shap

СформулированывВыводы по анализу важности признаков:

Здесь используем уловность класс 1 - покупательская активность вероятнее снизится, класс 0 - покупательская активность скорре останется без изменений. Рассмотрим признаки с сильным и средним влиянием. Разберем в порядке убывания важности.

- 1 При высоких значениях среднего количества просмотрои категорий за визит(`средний_просмотр_категорий_за_визит`) повышается вероятность, что клиент будет отнесен к  классу 0, при низких соответсвенно в классу 1.      
- 2 При высоких значениях среднего количества просмотров страниц за визит (`страниц_за_визит`) повышается вероятность, что клиент  будет отнесен к классу 0. 
- 3 При высоких значениях количества минут проведенных на сайте за предыдущий месяц (`минут_за_предыдущий_месяц`)  повышается вероятность, что клиент  будет отнесен к классу 0. 
- 4 При высоких значениях среднемесячной доли покупок по акции от общего числа покупок ('акционные_покупки') повышается вероятность, что клиент  будет отнесен к классу 1.
- 5  При высоких значениях количества минут проведенных на сайте за текущий месяц (`минут_за_текущтй_месяц`)  повышается вероятность, что клиент  будет отнесен к классу 0. 
- 6 При высоких значениях среднемесячное количества маркетинговых коммуникаций компании('маркет_актив_6_мес') повышается вероятность, что клиент  будет отнесен к классу 0.
- 7 При высоких значениях количества неоплаченного товара в корзине(`неоплаченные_продукты_штук_квартал`)  повышается вероятность, что клиент  будет отнесен к классу 1.
- 8 Низкие значения выручки за препредыдущий месяц склоняет вероятность, что клиент  будет отнесен к классу 1 
- 9 Доминирование категории мелкая бытовая техника и элетроника тповышает вероятность, что клиент  будет отнесен к классу 0
На основе данных выводов возможно сформулировать следующие рекомендации.

Первые 2 признака - связаны с ассортиментом товаров, чем больше интерсных прделождений тем вероятнее сохранять интерес. Логичным образом к ним присоедиянятся и признак количество проведенных минут сайте.
Закономерно, что многие стремятся минимизировать затраты и интересуются акционными прделожениями, и их активность снижается если акционные мероприятия становятся реже.
Низкое количество маркетинговых коммуникаций негативно влияет на покупательскую активность.
Если клиент накапливает в корзине неоплаченные товары это признак, что его активность может сократиться, возможно следует анализировать такие "накопления" и планировать маркетинговые акции с их учетом.



Сегментация покупателей

На основе вероятностей классификации клиента классом 1(т.е. покупательская активность снизится) и данных о прибыльности клиентов определены сегменты для которых прогнозируется высокая веротность снижения покупательской активности (вероятность класса 1 более 0.8) и сегмент для которого определена низкая верояность снижения покупательской активности (вероятность класса 1 менее 0.2) Прибыльность на первом этапе рассмотрения начиналсь от 2 - т.е. средняя и высокая На втором этапе от 3.5 более высокоприбыльный сегмент.

Рассмотрены признаки классификации с важностью по Shap > 0.3

Повышение уровня прибыльности сделало картину отличий более контрастной. Сформулируем выводы.

средний_просмотр_категорий_за_визит для сегмента, которому прогнозируется высоковероятное снижение активности доминирует среднее количество категорий 2-3 в то время как для противоположного по вероятности сегемента 3-5.

страниц_за_визит здесь еще более четким стало различие - клиенты сегмента высоковероятного снижения активности просматривают 1-5 страниц, против 6-13 для сегмента антагониста по вероятности класса авктивности.

минут_за_предыдущий_месяц контрастное отличие, клиенты сегмента высоковероятного снижения активности тратят меньше времени на сайте их средее время около 8 против 16ти минут для клиентов низковероятного снижения активности.

появился контраст в признаке минут_за_текущий_месяцситуация похожа на предыдущий признак клиенты сегмента высоковероятного снижения активности тратят меньше времени на сайте их средее время около 10 против 15ти минут для клиентов наменее вероятно снижущих активность..

добавился контраст в маркет_актив_мес если среднеее количество коммуникаций не более 2.3-4.3 то вероятнность того, что клиент снизит активность повышается, а вот если 4-6 то скорее не снизит.

Накопление свыше 5 неоплаченых покупок характерно для клиентов высоковероятного снижения активности.

По результатам выводов сформулирую рекомендации по снижению вероятности изменения покупательской активности на негативную:

Важно поддерживать интерес клиентов - быть предствительным местом, адекватным трендам потребления, с разнообразным выбором товаров, повышенное внимание нужно сосредоточить в предствительности категории товаров мелкая бытовая техника и электроника и техника для красоты и здоровья.
Чтобы удерживать внимание клиентов стоит расмотреть увеличение функционала сайта - например положительно скажется снабжение карточек товаров рекомендательными ссылками по типу предложения аналогов в сторону более и менее однокласных вещй и/или необходимых расходников...
Важно поддерживать баланс в маркетинговых коммуникациях с клиентом, напоминать о себе по возможности деликатнее. Но далать это ни часто ни редко, как показал анализ - положительно сказывается количество среднемесячных коммуникаций около 5.